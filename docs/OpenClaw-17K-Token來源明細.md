# OpenClaw 17K Token 來源明細

OpenClaw Gateway 會把 **workspace 的 7 個 bootstrap 檔案**整份讀進 system prompt。目前這 7 個檔的**字數加總 ≈ 17,125 字元**；中文為主的內容大約 **1 字元 ≈ 1 token**，所以整體約 **~17K token** 就是來自這裡。

---

## 一、Bootstrap 檔案（每次對話都會載入）

| 檔案 | 字元數 (chars) | 預估 Token (約) | 說明 |
|------|----------------|-----------------|------|
| **SOUL.md** | 3,862 | ~3,900 | 身份、邊界、防護規則、資料保護 |
| **HEARTBEAT.md** | 3,277 | ~3,300 | 心跳邏輯、Moltbook 檢查、備份指令（含程式碼） |
| **AGENTS.md** | 3,084 | ~3,100 | 每輪流程、Memory 規則、Safety、Tools、Heartbeat 說明 |
| **MEMORY.md** | 2,679 | ~2,700 | 已改為關鍵字索引（仍約 2.7K 字） |
| **TOOLS.md** | 2,007 | ~2,000 | 任務板、網站、路徑、省 Token、Cursor、技能簡表 |
| **USER.md** | 1,892 | ~1,900 | 老蔡的稱呼、事業、偏好、執行習慣 |
| **IDENTITY.md** | 324 | ~330 | 簡短身份 |
| **合計** | **17,125** | **~17,200** |  |

以上 7 個檔案就是 **17K token 的主要來源**。  
（BOOTSTRAP.md 若不存在則不載入；MEMORY_INDEX.md、SKILLS_INDEX.md **不在** bootstrap 名單內，不會被自動載入。）

---

## 二、還有可能加進去的部分（視實作而定）

- **技能列表**：若 Gateway 會把「已啟用技能」的名稱+描述打進 prompt，會再多幾百～幾千 token（依技能數量與描述長度）。
- **每日筆記**：若在 AGENTS 裡要求「讀 memory/今天+昨天」，Agent 可能會再讀 `memory/2026-02-07.md`、`2026-02-08.md`（各約 565–575 字），再加約 1K 字/約 1K token。
- **系統模板／固定指令**：OpenClaw 本身的 system 開頭、結尾或指令也會佔一些 token。

所以 **17K 幾乎就是「這 7 個 bootstrap 檔」**；其餘是技能列表、每日、系統模板等疊上去的結果。

---

## 三、優化後 Token 可達範圍（索引 + 主題 + 比例分配）

在「索引對齊記憶庫 + 當前主題 + 比例分配（主導 ≥70% 只載入主導+匹配）」的情況下：

| 情境 | Bootstrap（固定） | 變動部分（每輪） | 總量預估（單次請求） |
|------|-------------------|------------------|------------------------|
| **現狀（已做索引+主題+比例）** | ~17.5K token（7 檔未再縮） | 只載入主導 + 有匹配的記憶區塊，約 0.5～1.5K；每日筆記若改為關鍵字觸發再讀可再省 ~1K | **約 18～19K**（較原先 19K+ 略降，變動部分明顯減少） |
| **再縮 Bootstrap（HEARTBEAT/SOUL/AGENTS 精簡或改索引）** | 約 11～12K token | 同上 | **約 12～14K** |
| **積極（多數改索引 + 按需讀取）** | 約 8～10K token | 約 1K | **約 9～11K** |

- **主題 + 比例**主要省的是**變動部分**：不再每輪引入多個記憶區塊，只帶主導 + 匹配，所以「疊上去」的 token 從可能 2～4K 降到約 0.5～1.5K。
- 要明顯壓低**總量**，關鍵仍是**縮 Bootstrap**：動 HEARTBEAT、SOUL、AGENTS、TOOLS、USER（見下表），才能從 ~17K 降到 ~12K 甚至 ~10K。

---

## 四、若要再降 Token，可優先動的檔案（由大→小）

| 優先 | 檔案 | 目前 | 建議 |
|------|------|------|------|
| 1 | **HEARTBEAT.md** | 3,277 字 | 只留「何時做什麼」的短指示；Moltbook/備份的**具體程式碼**移到 `scripts/`，用「需要時執行 xxx 腳本」一句帶過。 |
| 2 | **SOUL.md** | 3,862 字 | 保留核心原則與防護要點；範例、長說明可移到 SOUL_FULL.md，改為「必要時再讀」。 |
| 3 | **AGENTS.md** | 3,084 字 | 精簡「Memory」「Heartbeat」重複說明；或拆成 AGENTS_INDEX + 按需讀取。 |
| 4 | **MEMORY.md** | 2,679 字 | 已是指索；若再壓可只留「關鍵字行」+ 一句「完整見 MEMORY_FULL.md」。 |
| 5 | **TOOLS.md** | 2,007 字 | 技能詳表改為「見 SKILLS_INDEX」一句；只留任務板、Cursor、路徑等最常用。 |
| 6 | **USER.md** | 1,892 字 | 可縮成「稱呼、時區、事業一句、偏好 bullet」；細節改放 USER_FULL 按需讀。 |

這樣可以清楚看到：**17K 從哪裡來**、**優化後 Token 可降到多少**，以及**要再降 token 該先縮哪幾個檔**。
