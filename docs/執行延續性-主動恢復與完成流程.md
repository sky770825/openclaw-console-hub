# 執行延續性 — 主動恢復與完成流程

**問題**：Agent 說「要去看網站」或「我去查一下」之後就沒有後續，必須等使用者再回一句，它才會繼續執行。執行缺乏延續性。

**目標**：讓 Agent 在**同一輪（或同一 run）內**把說要做的事做完，具備「主動跑完流程」的習慣，而不是只說不做、等使用者催。

---

## 一、為什麼會「說一做零」？

常見情況是 **Agent 先回了一則「我要去…」的純文字**，沒有在同一則回覆裡**呼叫工具**。從系統角度：

- 若 Agent 的輸出是「純文字」且沒有 tool_calls，框架就會把這段話當成**最終回覆**送給使用者，然後**等使用者下一則訊息**。
- 若 Agent 的輸出裡有 **tool_calls**（例如 `browser_navigate`），框架會執行工具、把結果塞回給模型，模型可以**再產出**下一輪（繼續呼叫工具或回覆使用者）。

所以「沒有後續」多半是：**模型在該輪選擇了「只回文字、不呼叫工具」**，而不是框架不讓它繼續。

---

## 二、怎麼讓它「主動恢復／跑完」？

核心是：**讓 Agent 養成「說要做就同一輪做」的習慣**，在決定要做一件事時，**先呼叫工具**，用工具結果再決定下一步，而不是先回一句話就結束。

### 1. 靠指引（已做）

在 **AGENTS.md** 與 **SOUL.md** 已加入「執行延續性」規則，開頭就會讀到：

- **同一輪完成動作**：要去看網站 → 立刻呼叫對應工具（如 browser_navigate），拿到結果後再視需要繼續（snapshot、點擊等），最後再回覆使用者；不要只回「我去看一下」就結束。
- **多步驟流程一次跑完**：A → B → C 在同一輪內依序做；只有流程做完、或真的需要使用者輸入時，才回訊息給使用者。
- **例外**：需要確認的敏感操作先問；其餘可自己做的，直接做。

這樣新 session 都會載入這些規則，有助減少「只說不做」的狀況。

### 2. 框架本身已經支援「延續」

OpenClaw 的執行迴圈是：**使用者一則訊息 → 模型可多次產出（每次可含 tool_calls）→ 工具結果會回傳給模型 → 直到模型產出不含 tool_calls 的最終回覆**。  
也就是說，**不需要使用者再送一句**，只要模型在該 run 內持續產出 tool_calls，框架就會一直執行工具並把結果塞回去，形成「主動恢復／接續」的效果。  
關鍵是：**模型要選擇在該輪就發出 tool_calls**，而不是先回一段話就停。

### 3. 為什麼還是感覺「我講一句，他才動一下」？

常見原因是：**模型在執行一、兩個 tool 後就回了一段話給使用者**（例如「我已經打開網頁了」「正在處理」）。系統會把這段話當成**本輪的最終回覆**，於是停住、等使用者下一則訊息。所以使用者體驗就變成「講一句 → 他動一下（一個 tool）→ 他回一句 → 停住 → 又要我講一句」。

**解法**：模型在執行多步驟任務時，**不要中途回覆使用者**。只產出 tool_calls，讓工具結果回傳後繼續產出下一批 tool_calls，直到整件事做完，**再**產出一段給使用者的總結。這樣同一則使用者訊息內就會「一路跑完」，不需要使用者再講一句。

已在 AGENTS.md 加強：「執行中不要中途回話」「只有整串步驟都做完才回老蔡一句」。

### 4. 「好」與批准語 = 請執行

若小蔡先提了計畫或 idea，老蔡只回「好」「可以」「去做」等，小蔡有時會只回「好的」就停住，沒有真的去執行。  
**約定**：老蔡的「好」= **批准你去執行**。小蔡要解讀為「請立刻呼叫工具、開始做」，不要只回一句就沒下文。  
已在 AGENTS.md、USER.md 寫明：當老蔡回「好」「可以」「去做」「執行」「開始做」「請執行」時，小蔡要立刻執行，不要只回「好的」。

### 5. 若仍常停住，可再強化的方向

- **提醒句**：在 USER.md 加一句：「你執行任務時請一路做到底，中間不要停下來回覆我，做完再一次跟我說結果。」
- **事後檢視**：若某次又「動一下就停」，把對話截給小蔡看，說「這裡你應該繼續呼叫下一個 tool，不要先回我話，照 AGENTS.md 執行延續性規則」。

---

## 三、一句話總結

**延續性** = 說要做的事在**同一輪內就做**（呼叫工具 → 依結果繼續 → 做完再回覆）。  
已在 **AGENTS.md / SOUL.md** 寫明「說要做就做、多步驟一次跑完」；OpenClaw 會把工具結果持續塞回給模型，**只要模型在該輪就發出 tool_calls**，就會自然形成主動恢復、不需使用者再回一句才繼續。
