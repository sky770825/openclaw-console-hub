# OpenClaw — 需要注意而容易忽略的檢查清單

依你目前環境整理：**安全、通道、Gateway、模型、日常** 幾類，方便定期看一眼、避免事後才發現問題。

---

## 一、安全（Security audit）

`openclaw status` 會顯示 **Security audit**，目前你有：

| 項目 | 狀態 | 建議 |
|------|------|------|
| **小模型 + 沙箱** | 2 critical | fallback 用了 `ollama/qwen2.5:14b`，但 sandbox=off、web 工具開著。若會跑本機小模型，建議：`agents.defaults.sandbox.mode: "all"`，或 `tools.deny: ["group:web","browser"]`，或改 fallback 為雲端模型。詳見 `openclaw security audit`。 |
| **plugins.allow 未設** | 1 critical | `~/.openclaw/extensions` 有擴充時，建議在 config 設 `plugins.allow: ["你信任的 plugin id 列表"]`，避免載入未預期的外掛。 |
| **Gateway token 太短** | 1 warn | 目前 token 約 9 字元；`bind=lan` 時建議用較長隨機 token，減少被猜到的風險。 |

可定期跑：`openclaw security audit`（必要時加 `--deep`）。

---

## 二、Telegram / 通道

| 項目 | 說明 | 建議 |
|------|------|------|
| **私訊要配對** | `dmPolicy: "pairing"` 時，只有已核准帳號的私訊會回。 | 新的人要回覆：先讓對方對 bot 發一則訊息，再 `openclaw pairing list telegram` → `openclaw pairing approve telegram <code>`。 |
| **群組要 @ 且可能需白名單** | `groupPolicy: "allowlist"`、`requireMention: true`。 | 群組裡一定要 **@ 你的 bot**；若群組完全沒反應，需把該群組 ID 加入 Telegram 的 group allowlist（見官方文件）。 |
| **主模型 429 → 回很慢** | 主模型額度用完會 fallback 到本機（如 ollama），可能等 1–2 分鐘。 | 留意日誌 429；必要時改 primary 為額度還夠的模型，或接受 fallback 並多等一會。 |
| **WhatsApp 開著但未連結** | 目前 ON 但 Not linked。 | 若不用 WhatsApp：可在 config 關掉 `channels.whatsapp.enabled: false`，減少警告；若要用：`openclaw channels login` 掃 QR。 |

詳見：`docs/Telegram傳給OpenClaw沒有反應-排查.md`。

---

## 三、Gateway 與更新

| 項目 | 說明 | 建議 |
|------|------|------|
| **更新 openclaw 後要重啟 Gateway** | 套件更新會改 dist 裡 chunk 檔名；舊的 Gateway 進程仍載入舊檔名，回覆 Telegram 時會 `Cannot find module auth-profiles-xxx.js`。 | 每次 `npm update -g openclaw` 或重裝後，執行：`openclaw gateway stop` → `openclaw gateway install`（或讓 LaunchAgent 重啟）。 |
| **bind=lan 時 token 必填** | 非 loopback 時沒 token 會拒絕啟動。 | 確認 `~/.openclaw/openclaw.json` 裡 `gateway.auth.token` 與實際啟動參數、Control UI、擴充一致。 |
| **Chrome 擴充 / Control UI** | 連 Gateway 時需帶同一 token。 | 擴充設定裡填好 `gateway.auth.token`；本機 Control UI 若用 127.0.0.1 可預設 dev-local（見修復紀錄）。 |

---

## 四、模型與 Ollama

| 項目 | 說明 | 建議 |
|------|------|------|
| **Fallback 到 Ollama 時** | 主模型 429 或失敗會用 fallback（如 qwen2.5:14b）。 | 若預期會 fallback，先確認 Ollama 有在跑：`curl -s http://127.0.0.1:11434/api/tags`。 |
| **本機小模型易洩漏背景** | 小模型有時會把 USER.md、MEMORY 等當成回覆內容。 | 若不想被貼出，可精簡 `~/.openclaw` 下的 USER.md，或預設用雲端模型。 |
| **開機自動跑 Ollama** | 若希望重開機後 bot 也能用本機模型。 | 可設 LaunchAgent 或系統登入時啟動 Ollama（見 `開機自動啟動Ollama.md`）。 |

---

## 五、日常可做的檢查

| 頻率 | 動作 |
|------|------|
| **偶爾** | `openclaw status` 看 Gateway、Channels、Sessions 是否正常。 |
| **偶爾** | `openclaw doctor` 看服務、config、通道是否有建議修復。 |
| **出問題時** | `openclaw logs --follow` 看即時日誌（429、handler failed、pairing、mention 等）。 |
| **更新後** | 重啟 Gateway（見上方「Gateway 與更新」）。 |

---

## 六、對照：常見問題總覽

若遇到「某現象」不知從何查起，可先對照：

- **大家經常遇到的 OpenClaw 問題**：`docs/大家經常遇到的OpenClaw問題.md`  
- **錯誤訊息 ↔ 解法**：`docs/OpenClaw-修復紀錄報告.md` § 五、§ 七  

這份清單是「預防性」的注意事項；實際報錯時以修復紀錄與各排查說明為準。
