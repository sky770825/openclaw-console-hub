# 任務看板 — 版面檢查與修復說明

**檢查日期：** 2026-02-03

---

## 一、已修復項目

### 1. 任務看板（TaskBoard）

| 項目 | 說明 |
|------|------|
| **新增任務** | 「新增任務」按鈕改為開啟「新增任務」側邊表單，可填名稱、說明、狀態、優先級、負責人、排程；建立後會重整列表並顯示成功提示。 |
| **空狀態** | 無任務或篩選後無結果時顯示空狀態文案，並提供「新增任務」或「清除篩選」按鈕。 |
| **任務詳情 URL** | 點擊任務卡會導向 `/tasks/:taskId`，詳情抽屜與網址同步；關閉抽屜會回到 `/tasks`。 |
| **卡片下拉選單** | 「編輯」→ 開啟詳情抽屜並切到編輯分頁；「查看執行紀錄」→ 導向 `/runs?task=:id`；「刪除」→ 跳出確認對話框，確認後刪除並重整。 |
| **詳情抽屜** | 新增「編輯」分頁，可修改名稱、說明、狀態、優先級、負責人、排程表達式並儲存；「刪除任務」按鈕會先確認再刪除。 |
| **刪除任務** | 支援從卡片下拉與詳情抽屜刪除，並已加入 `deleteTask` API（mock 與 apiClient）。 |

### 2. 任務列表（TaskList）

| 項目 | 說明 |
|------|------|
| **列點擊** | 點擊列會導向 `/tasks/:taskId`，在任務看板頁開啟該任務的詳情抽屜。 |
| **編輯** | 下拉選單「編輯」→ 導向 `/tasks/:taskId`，在看板頁開啟詳情。 |
| **移至 Blocked / 解除封鎖** | 下拉選單項目會呼叫 API 更新狀態，並顯示成功/失敗 toast。 |
| **批次：執行選取項目** | 對所選任務依序呼叫「立即執行」，完成後重整列表、清空選取並顯示成功訊息。 |
| **批次：移至 Blocked** | 對所選任務將狀態改為 `blocked`，重整列表、清空選取並顯示成功訊息。 |

### 3. API 與資料

| 項目 | 說明 |
|------|------|
| **deleteTask** | 在 `services/api.ts` 的 mock 與 `apiClient` 中新增刪除任務，並在 api 匯出中提供。 |
| **路由** | 新增 `/tasks/:taskId`，由 TaskBoard 處理並依 `taskId` 開啟對應任務詳情抽屜。 |

---

## 二、顯示與操作注意事項

### 看板（Kanban）

- **六欄**：Draft → Ready → Running → Review → Done → Blocked；欄標題有 tooltip 說明定義。
- **卡片**：hover 時顯示「執行」與「⋯」下拉（編輯 / 查看執行紀錄 / 刪除）。
- **手機/平板**：改為垂直排列各狀態區塊，同一狀態內為網格卡片。

### 任務列表

- **排序**：名稱、狀態、優先級、下次執行可點欄標題切換升/降冪。
- **分頁**：每頁 10 筆，底下有「上一頁 / 下一頁」與筆數說明。
- **篩選**：狀態、優先級、排程類型可多選篩選，篩選後無結果會顯示空狀態與「清除篩選」。

### 共用

- **執行**：點「執行」或「立即執行」會呼叫 `api.runNow`，並以輪詢更新 Run 狀態（mock 下狀態可能維持 queued/running，僅示範流程）。
- **執行紀錄**：詳情抽屜「執行」分頁與「查看執行紀錄」皆會導向執行紀錄頁（`/runs` 或 `/runs?task=:id`）。

---

## 三、仍為佔位或未實作

| 項目 | 說明 |
|------|------|
| **變更歷史** | 詳情抽屜「歷史」分頁目前為「變更歷史即將推出...」佔位。 |
| **拖曳排序** | 看板卡片上的 GripVertical 僅為視覺，尚未接拖放改變狀態。 |
| **後端 API** | 目前以 localStorage + seed 為主；若設定 `VITE_API_BASE_URL` 會改用 apiClient，需後端實作對應的 REST（含 createTask/deleteTask 等）。 |

---

## 四、建議後續可做

1. **拖曳**：在看板欄位間拖放卡片以更新任務狀態（需呼叫 `updateTask(..., { status })`）。
2. **歷史**：若有審計或變更 log，可接上「歷史」分頁。
3. **權限**：若有多角色，可依身分隱藏/停用「刪除」「編輯」等按鈕。
4. **真實執行**：將 `runNow` 接上 OpenClaw 或實際 runner，讓「執行」真正觸發任務。

---

*本說明對應專案：openclaw-console-hub-main（Openclaw 任務面板）。*
